# GPT Team ç®¡ç†ç³»ç»Ÿ - API æ¥å£æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº† GPT Team ç®¡ç†ç³»ç»Ÿçš„æ‰€æœ‰ API æ¥å£å®šä¹‰ï¼ŒåŒ…æ‹¬å·²å®ç°å’Œå¾…å®ç°çš„æ¥å£ã€‚

---

## æ¥å£çŠ¶æ€è¯´æ˜

- âœ… **å·²å®ç°**: æ¥å£å·²å®Œæˆå¼€å‘å’Œæµ‹è¯•
- â³ **å¾…å®ç°**: æ¥å£å·²è®¾è®¡ä½†å°šæœªå®ç°
- ğŸ”’ **éœ€è¦è®¤è¯**: æ¥å£éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™

---

## 1. è®¤è¯æ¥å£ (Authentication)

### 1.1 ç®¡ç†å‘˜ç™»å½• âœ…

**æ¥å£ä¿¡æ¯**
```
POST /auth/login
```

**è¯·æ±‚ä½“**
```json
{
  "password": "ç®¡ç†å‘˜å¯†ç "
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "error": null
}
```

**çŠ¶æ€ç **
- `200`: ç™»å½•æˆåŠŸ
- `401`: å¯†ç é”™è¯¯
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- ç™»å½•æˆåŠŸåä¼šåœ¨ Session ä¸­å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
- Session æœ‰æ•ˆæœŸä¸º 14 å¤©

---

### 1.2 ç®¡ç†å‘˜ç™»å‡º âœ…

**æ¥å£ä¿¡æ¯**
```
POST /auth/logout
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "ç™»å‡ºæˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: ç™»å‡ºæˆåŠŸ
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- æ¸…é™¤ Session ä¸­çš„ç”¨æˆ·ä¿¡æ¯

---

### 1.3 ä¿®æ”¹ç®¡ç†å‘˜å¯†ç  âœ… ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /auth/change-password
```

**è¯·æ±‚ä½“**
```json
{
  "old_password": "æ—§å¯†ç ",
  "new_password": "æ–°å¯†ç "
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•",
  "error": null
}
```

**çŠ¶æ€ç **
- `200`: ä¿®æ”¹æˆåŠŸ
- `400`: æ—§å¯†ç é”™è¯¯æˆ–æ–°å¯†ç ä¸ç¬¦åˆè¦æ±‚
- `401`: æœªç™»å½•
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æ–°å¯†ç æœ€å°‘ 6 ä½
- ä¿®æ”¹æˆåŠŸåä¼šæ¸…é™¤ Sessionï¼Œéœ€è¦é‡æ–°ç™»å½•

---

### 1.4 è·å–è®¤è¯çŠ¶æ€ âœ…

**æ¥å£ä¿¡æ¯**
```
GET /auth/status
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "authenticated": true,
  "user": {
    "username": "admin",
    "is_admin": true
  }
}
```

**çŠ¶æ€ç **
- `200`: æˆåŠŸ

**è¯´æ˜**
- è¿”å›å½“å‰ç”¨æˆ·çš„è®¤è¯çŠ¶æ€
- å¦‚æœæœªç™»å½•ï¼Œ`authenticated` ä¸º `false`ï¼Œ`user` ä¸º `null`

---

## 2. å…‘æ¢æ¥å£ (Redemption)

### 2.1 éªŒè¯å…‘æ¢ç  âœ…

**æ¥å£ä¿¡æ¯**
```
POST /redeem/verify
```

**è¯·æ±‚ä½“**
```json
{
  "code": "å…‘æ¢ç "
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "valid": true,
  "reason": null,
  "teams": [
    {
      "id": 1,
      "team_name": "Team Name",
      "current_members": 3,
      "max_members": 6,
      "expires_at": "2024-12-31T23:59:59",
      "subscription_plan": "Plus"
    }
  ],
  "error": null
}
```

**çŠ¶æ€ç **
- `200`: éªŒè¯æˆåŠŸ
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éªŒè¯å…‘æ¢ç æ˜¯å¦æœ‰æ•ˆï¼ˆå­˜åœ¨ã€æœªä½¿ç”¨ã€æœªè¿‡æœŸï¼‰
- è¿”å›å¯ç”¨çš„ Team åˆ—è¡¨ï¼ˆæˆå‘˜æ•° < 6 ä¸”æœªè¿‡æœŸï¼‰
- å¦‚æœå…‘æ¢ç æ— æ•ˆï¼Œ`valid` ä¸º `false`ï¼Œ`reason` åŒ…å«åŸå› 

---

### 2.2 ç¡®è®¤å…‘æ¢å¹¶åŠ å…¥ Team âœ…

**æ¥å£ä¿¡æ¯**
```
POST /redeem/confirm
```

**è¯·æ±‚ä½“**
```json
{
  "email": "user@example.com",
  "code": "å…‘æ¢ç ",
  "team_id": 1
}
```

**å‚æ•°è¯´æ˜**
- `email`: ç”¨æˆ·é‚®ç®±ï¼ˆå¿…å¡«ï¼‰
- `code`: å…‘æ¢ç ï¼ˆå¿…å¡«ï¼‰
- `team_id`: Team IDï¼ˆå¯é€‰ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨é€‰æ‹©æˆå‘˜æ•°æœ€å°‘çš„ Teamï¼‰

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "æˆåŠŸåŠ å…¥ Team: Team Name",
  "team_info": {
    "id": 1,
    "team_name": "Team Name",
    "account_id": "account-xxx"
  },
  "error": null
}
```

**çŠ¶æ€ç **
- `200`: å…‘æ¢æˆåŠŸ
- `400`: å…‘æ¢ç ä¸å­˜åœ¨ã€å·²ä½¿ç”¨æˆ–å·²è¿‡æœŸ
- `409`: Team å·²æ»¡
- `500`: æœåŠ¡å™¨é”™è¯¯æˆ– ChatGPT API è°ƒç”¨å¤±è´¥

**è¯´æ˜**
- è°ƒç”¨ ChatGPT API å‘é€é‚€è¯·
- ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡å’Œè¡Œé”é˜²æ­¢å¹¶å‘å†²çª
- æˆåŠŸåæ›´æ–°å…‘æ¢ç çŠ¶æ€ã€è®°å½•ä½¿ç”¨è®°å½•ã€æ›´æ–° Team æˆå‘˜æ•°

---

## 3. ç®¡ç†å‘˜é¢æ¿æ¥å£ (Admin Panel)

### 3.1 ç®¡ç†å‘˜é¢æ¿é¦–é¡µ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin
```

**å“åº”**
- è¿”å›ç®¡ç†å‘˜é¢æ¿é¦–é¡µ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å±•ç¤º Team åˆ—è¡¨ã€ç»Ÿè®¡ä¿¡æ¯ç­‰

---

### 3.2 Team å¯¼å…¥é¡µé¢ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin/teams/import
```

**å“åº”**
- è¿”å› Team å¯¼å…¥é¡µé¢ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æ”¯æŒå•ä¸ªå¯¼å…¥å’Œæ‰¹é‡å¯¼å…¥

---

### 3.3 å¤„ç† Team å¯¼å…¥ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/teams/import
```

**è¯·æ±‚ä½“**
```json
{
  "import_type": "single",
  "access_token": "eyJhbGc...",
  "email": "admin@example.com",
  "account_id": "account-xxx"
}
```

æˆ–æ‰¹é‡å¯¼å…¥ï¼š

```json
{
  "import_type": "batch",
  "content": "eyJhbGc... admin@example.com account-xxx\neyJhbGc... admin2@example.com account-yyy"
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "æˆåŠŸå¯¼å…¥ 2 ä¸ª Team",
  "imported": 2,
  "failed": 0,
  "errors": []
}
```

**çŠ¶æ€ç **
- `200`: å¯¼å…¥æˆåŠŸ
- `400`: å‚æ•°é”™è¯¯
- `401`: æœªç™»å½•
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æ”¯æŒå•ä¸ªå¯¼å…¥å’Œæ‰¹é‡å¯¼å…¥
- æ‰¹é‡å¯¼å…¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è‡ªåŠ¨è¯†åˆ« ATã€é‚®ç®±ã€account-id
- éªŒè¯å’Œè§£æ ATï¼ˆJWTï¼‰
- åŠ å¯†å­˜å‚¨ AT
- åŒæ­¥æˆå‘˜æ•°é‡å’Œè®¢é˜…ä¿¡æ¯

---

### 3.4 åˆ‡æ¢ Team account-id â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/teams/{id}/switch
```

**è¯·æ±‚ä½“**
```json
{
  "account_id": "account-yyy"
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "åˆ‡æ¢æˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: åˆ‡æ¢æˆåŠŸ
- `400`: account-id ä¸å­˜åœ¨
- `401`: æœªç™»å½•
- `404`: Team ä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å¦‚æœä¸€ä¸ª AT å…³è”å¤šä¸ª Teamï¼Œå¯ä»¥åˆ‡æ¢åˆ°å…¶ä»– Team

---

### 3.5 åˆ é™¤ Team â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/teams/{id}/delete
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: åˆ é™¤æˆåŠŸ
- `401`: æœªç™»å½•
- `404`: Team ä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- åˆ é™¤ Team è®°å½•

---

### 3.6 æˆå‘˜ç®¡ç†é¡µé¢ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin/teams/{id}/members
```

**å“åº”**
- è¿”å›æˆå‘˜ç®¡ç†é¡µé¢ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å±•ç¤º Team æˆå‘˜åˆ—è¡¨

---

### 3.7 æ·»åŠ æˆå‘˜ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/teams/{id}/members/add
```

**è¯·æ±‚ä½“**
```json
{
  "email": "user@example.com"
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "æˆå‘˜æ·»åŠ æˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: æ·»åŠ æˆåŠŸ
- `400`: é‚®ç®±æ ¼å¼é”™è¯¯æˆ– Team å·²æ»¡
- `401`: æœªç™»å½•
- `404`: Team ä¸å­˜åœ¨
- `409`: ç”¨æˆ·å·²æ˜¯æˆå‘˜
- `500`: æœåŠ¡å™¨é”™è¯¯æˆ– ChatGPT API è°ƒç”¨å¤±è´¥

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- è°ƒç”¨ ChatGPT API å‘é€é‚€è¯·

---

### 3.8 åˆ é™¤æˆå‘˜ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/teams/{id}/members/{user_id}/delete
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "æˆå‘˜åˆ é™¤æˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: åˆ é™¤æˆåŠŸ
- `400`: ä¸èƒ½åˆ é™¤ owner
- `401`: æœªç™»å½•
- `404`: Team æˆ–æˆå‘˜ä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯æˆ– ChatGPT API è°ƒç”¨å¤±è´¥

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- è°ƒç”¨ ChatGPT API åˆ é™¤æˆå‘˜
- owner ä¸å¯åˆ é™¤

---

### 3.9 å…‘æ¢ç ç®¡ç†é¡µé¢ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin/codes
```

**å“åº”**
- è¿”å›å…‘æ¢ç ç®¡ç†é¡µé¢ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å±•ç¤ºå…‘æ¢ç åˆ—è¡¨

---

### 3.10 ç”Ÿæˆå…‘æ¢ç  â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/codes/generate
```

**è¯·æ±‚ä½“**
```json
{
  "type": "batch",
  "count": 10,
  "expires_days": 30
}
```

æˆ–å•ä¸ªç”Ÿæˆï¼š

```json
{
  "type": "single",
  "code": "CUSTOM-CODE",
  "expires_days": 30
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "æˆåŠŸç”Ÿæˆ 10 ä¸ªå…‘æ¢ç ",
  "codes": [
    {
      "code": "ABC123",
      "expires_at": "2024-12-31T23:59:59"
    }
  ]
}
```

**çŠ¶æ€ç **
- `200`: ç”ŸæˆæˆåŠŸ
- `400`: å‚æ•°é”™è¯¯æˆ–è‡ªå®šä¹‰å…‘æ¢ç å·²å­˜åœ¨
- `401`: æœªç™»å½•
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æ”¯æŒæ‰¹é‡ç”Ÿæˆå’Œå•ä¸ªç”Ÿæˆ
- æ‰¹é‡ç”Ÿæˆä½¿ç”¨éšæœºå­—ç¬¦ä¸²
- å•ä¸ªç”Ÿæˆå¯è‡ªå®šä¹‰å…‘æ¢ç 

---

### 3.11 ä½¿ç”¨è®°å½•é¡µé¢ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin/records
```

**å“åº”**
- è¿”å›ä½¿ç”¨è®°å½•é¡µé¢ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å±•ç¤ºæ‰€æœ‰å…‘æ¢è®°å½•

---

### 3.12 ç³»ç»Ÿè®¾ç½®é¡µé¢ â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /admin/settings
```

**å“åº”**
- è¿”å›ç³»ç»Ÿè®¾ç½®é¡µé¢ HTML

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- å±•ç¤ºç³»ç»Ÿé…ç½®ï¼ˆä»£ç†ã€æ—¥å¿—çº§åˆ«ç­‰ï¼‰

---

### 3.13 æ›´æ–°ç³»ç»Ÿè®¾ç½® â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
POST /admin/settings/update
```

**è¯·æ±‚ä½“**
```json
{
  "http_proxy": "http://proxy.example.com:8080",
  "https_proxy": "https://proxy.example.com:8080",
  "proxy_enabled": true,
  "log_level": "INFO"
}
```

**å“åº”ä½“**
```json
{
  "success": true,
  "message": "è®¾ç½®æ›´æ–°æˆåŠŸ"
}
```

**çŠ¶æ€ç **
- `200`: æ›´æ–°æˆåŠŸ
- `400`: å‚æ•°é”™è¯¯
- `401`: æœªç™»å½•
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æ›´æ–°ç³»ç»Ÿé…ç½®åˆ°æ•°æ®åº“

---

## 4. API ç«¯ç‚¹ (API Endpoints)

### 4.1 åˆ·æ–° Team æˆå‘˜æ•° â³ ğŸ”’

**æ¥å£ä¿¡æ¯**
```
GET /api/teams/{id}/refresh
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "success": true,
  "team_id": 1,
  "current_members": 4,
  "max_members": 6,
  "status": "active"
}
```

**çŠ¶æ€ç **
- `200`: åˆ·æ–°æˆåŠŸ
- `401`: æœªç™»å½•
- `404`: Team ä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯æˆ– ChatGPT API è°ƒç”¨å¤±è´¥

**è¯´æ˜**
- éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- è°ƒç”¨ ChatGPT API è·å–æœ€æ–°æˆå‘˜æ•°
- æ›´æ–°æ•°æ®åº“ä¸­çš„æˆå‘˜æ•°å’ŒçŠ¶æ€

---

### 4.2 è·å–å¯ç”¨ Team åˆ—è¡¨ â³

**æ¥å£ä¿¡æ¯**
```
GET /api/teams/available
```

**è¯·æ±‚ä½“**
æ— 

**å“åº”ä½“**
```json
{
  "success": true,
  "teams": [
    {
      "id": 1,
      "team_name": "Team Name",
      "current_members": 3,
      "max_members": 6,
      "expires_at": "2024-12-31T23:59:59",
      "subscription_plan": "Plus"
    }
  ]
}
```

**çŠ¶æ€ç **
- `200`: æˆåŠŸ
- `500`: æœåŠ¡å™¨é”™è¯¯

**è¯´æ˜**
- è¿”å›æ‰€æœ‰å¯ç”¨çš„ Teamï¼ˆæˆå‘˜æ•° < 6 ä¸”æœªè¿‡æœŸï¼‰
- ç”¨äºå‰ç«¯å±•ç¤ºå¯ç”¨ Team åˆ—è¡¨

---

## 5. ç³»ç»Ÿæ¥å£ (System)

### 5.1 æ ¹è·¯å¾„ - å¥åº·æ£€æŸ¥ âœ…

**æ¥å£ä¿¡æ¯**
```
GET /
```

**å“åº”ä½“**
```json
{
  "status": "ok",
  "message": "GPT Team ç®¡ç†ç³»ç»Ÿè¿è¡Œä¸­",
  "version": "0.1.0"
}
```

**çŠ¶æ€ç **
- `200`: ç³»ç»Ÿæ­£å¸¸è¿è¡Œ

---

### 5.2 å¥åº·æ£€æŸ¥ç«¯ç‚¹ âœ…

**æ¥å£ä¿¡æ¯**
```
GET /health
```

**å“åº”ä½“**
```json
{
  "status": "healthy"
}
```

**çŠ¶æ€ç **
- `200`: ç³»ç»Ÿå¥åº·

---

## 6. ChatGPT API é›†æˆ

æœ¬ç³»ç»Ÿé›†æˆäº† ChatGPT API ç”¨äº Team ç®¡ç†æ“ä½œã€‚è¯¦ç»†çš„ API æ–‡æ¡£è¯·å‚è€ƒ [openai-api.md](./openai-api.md)ã€‚

### 6.1 å‘é€é‚€è¯·

**æ¥å£ä¿¡æ¯**
```
POST https://chatgpt.com/backend-api/accounts/{account-id}/invites
```

**è¯·æ±‚å¤´**
```
Content-Type: application/json
Authorization: Bearer {AT}
chatgpt-account-id: {account-id}
```

**è¯·æ±‚ä½“**
```json
{
  "email_addresses": ["user@example.com"],
  "role": "standard-user",
  "resend_emails": true
}
```

**å“åº”å¤„ç†**
- `200/201`: é‚€è¯·æˆåŠŸ
- `409`: ç”¨æˆ·å·²æ˜¯æˆå‘˜
- `403`: Token æ— æ•ˆæˆ–æƒé™ä¸è¶³
- `422`: é‚®ç®±æ ¼å¼é”™è¯¯æˆ– Team å·²æ»¡
- `5xx`: æœåŠ¡å™¨é”™è¯¯ï¼Œéœ€é‡è¯•

**é‡è¯•ç­–ç•¥**
- æœ€å¤šé‡è¯• 3 æ¬¡
- æŒ‡æ•°é€€é¿ï¼š1s, 2s, 4s
- ä»…å¯¹ 5xx å’Œç½‘ç»œè¶…æ—¶é”™è¯¯é‡è¯•

---

### 6.2 æŸ¥çœ‹å›¢é˜Ÿæˆå‘˜

**æ¥å£ä¿¡æ¯**
```
GET https://chatgpt.com/backend-api/accounts/{account-id}/users?limit=50&offset=0
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer {AT}
```

---

### 6.3 åˆ é™¤æˆå‘˜

**æ¥å£ä¿¡æ¯**
```
DELETE https://chatgpt.com/backend-api/accounts/{account-id}/users/{user-id}
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer {AT}
chatgpt-account-id: {account-id}
```

---

### 6.4 è·å–è®¢é˜…ä¿¡æ¯

**æ¥å£ä¿¡æ¯**
```
GET https://chatgpt.com/backend-api/accounts/{account-id}
```

**è¯·æ±‚å¤´**
```
Authorization: Bearer {AT}
```

---

## 7. é”™è¯¯ç è¯´æ˜

### 7.1 HTTP çŠ¶æ€ç 

- `200`: è¯·æ±‚æˆåŠŸ
- `201`: åˆ›å»ºæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªç™»å½•æˆ–è®¤è¯å¤±è´¥
- `403`: æ— æƒé™è®¿é—®
- `404`: èµ„æºä¸å­˜åœ¨
- `409`: èµ„æºå†²çªï¼ˆå¦‚ Team å·²æ»¡ã€ç”¨æˆ·å·²æ˜¯æˆå‘˜ï¼‰
- `422`: è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

### 7.2 ä¸šåŠ¡é”™è¯¯ç 

æ‰€æœ‰æ¥å£çš„å“åº”ä½“éƒ½åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

```json
{
  "success": true/false,
  "message": "æˆåŠŸæˆ–é”™è¯¯ä¿¡æ¯",
  "error": "è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼ˆä»…åœ¨å¤±è´¥æ—¶è¿”å›ï¼‰"
}
```

---

## 8. è®¤è¯æœºåˆ¶

### 8.1 Session è®¤è¯

- ç®¡ç†å‘˜ç™»å½•åï¼ŒSession ä¿¡æ¯å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯
- Session æœ‰æ•ˆæœŸä¸º 14 å¤©
- Session Cookie åç§°ä¸º `session`
- éœ€è¦è®¤è¯çš„æ¥å£ä¼šæ£€æŸ¥ Session ä¸­çš„ç”¨æˆ·ä¿¡æ¯

### 8.2 æƒé™æ§åˆ¶

- ğŸ”’ æ ‡è®°çš„æ¥å£éœ€è¦ç®¡ç†å‘˜ç™»å½•æƒé™
- æœªç™»å½•è®¿é—®ä¼šè¿”å› `401 Unauthorized`
- æ— æƒé™è®¿é—®ä¼šè¿”å› `403 Forbidden`

---

## 9. æ•°æ®æ¨¡å‹

### 9.1 Team ä¿¡æ¯

```json
{
  "id": 1,
  "email": "admin@example.com",
  "account_id": "account-xxx",
  "team_name": "Team Name",
  "plan_type": "plus",
  "subscription_plan": "Plus",
  "expires_at": "2024-12-31T23:59:59",
  "current_members": 3,
  "max_members": 6,
  "status": "active"
}
```

### 9.2 å…‘æ¢ç ä¿¡æ¯

```json
{
  "id": 1,
  "code": "ABC123",
  "status": "unused",
  "used_by_email": null,
  "used_team_id": null,
  "used_at": null,
  "expires_at": "2024-12-31T23:59:59",
  "created_at": "2024-01-01T00:00:00"
}
```

### 9.3 ä½¿ç”¨è®°å½•

```json
{
  "id": 1,
  "email": "user@example.com",
  "code": "ABC123",
  "team_id": 1,
  "team_name": "Team Name",
  "redeemed_at": "2024-01-01T12:00:00"
}
```

---

## 10. å¼€å‘è®¡åˆ’

### 10.1 å·²å®Œæˆ âœ…

- [x] è®¤è¯æ¥å£ï¼ˆç™»å½•ã€ç™»å‡ºã€ä¿®æ”¹å¯†ç ã€è®¤è¯çŠ¶æ€ï¼‰
- [x] å…‘æ¢æ¥å£ï¼ˆéªŒè¯å…‘æ¢ç ã€ç¡®è®¤å…‘æ¢ï¼‰
- [x] ç³»ç»Ÿå¥åº·æ£€æŸ¥æ¥å£

### 10.2 å¾…å®ç° â³

- [ ] ç®¡ç†å‘˜é¢æ¿æ¥å£ï¼ˆTeam ç®¡ç†ã€æˆå‘˜ç®¡ç†ã€å…‘æ¢ç ç®¡ç†ï¼‰
- [ ] API ç«¯ç‚¹ï¼ˆåˆ·æ–° Team æˆå‘˜æ•°ã€è·å–å¯ç”¨ Team åˆ—è¡¨ï¼‰
- [ ] ç³»ç»Ÿè®¾ç½®æ¥å£

---

## 11. æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§**
   - æ‰€æœ‰å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨
   - AT Token ä½¿ç”¨ä¿¡å°åŠ å¯†å­˜å‚¨
   - ç®¡ç†å‘˜æ¥å£éœ€è¦ Session è®¤è¯

2. **å¹¶å‘æ§åˆ¶**
   - å…‘æ¢æµç¨‹ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡å’Œè¡Œé”ï¼ˆFOR UPDATEï¼‰é˜²æ­¢å¹¶å‘å†²çª
   - ç¡®ä¿ Team å®¹é‡æ£€æŸ¥çš„åŸå­æ€§

3. **é”™è¯¯å¤„ç†**
   - æ‰€æœ‰æ¥å£éƒ½æœ‰ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
   - ChatGPT API è°ƒç”¨å¤±è´¥ä¼šè‡ªåŠ¨é‡è¯•ï¼ˆä»…å¯¹ 5xx é”™è¯¯ï¼‰
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

4. **ä»£ç†æ”¯æŒ**
   - æ‰€æœ‰ ChatGPT API è°ƒç”¨æ”¯æŒä»£ç†é…ç½®
   - ä½¿ç”¨ curl_cffi æ¨¡æ‹Ÿæµè§ˆå™¨æŒ‡çº¹ç»•è¿‡ Cloudflare é˜²æŠ¤

5. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨å¼‚æ­¥ I/Oï¼ˆFastAPI + SQLAlchemy asyncï¼‰
   - æ•°æ®åº“è¿æ¥æ± ç®¡ç†
   - åˆç†çš„ç´¢å¼•è®¾è®¡

---

## 12. è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚
